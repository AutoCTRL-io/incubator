<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>WiFi Settings</title>
  <style>
    :root {
      --bg:#0f1216;
      --panel:#161b22;
      --text:#e6edf3;
      --muted:#9da7b1;
      --accent:#4cc9f0;
      --border:#2a2f36;
      --ok:#3fb950;
    }
    *{box-sizing:border-box}
    body{
      margin:0;padding:16px;
      background:linear-gradient(180deg,#0f1216,#0b0e12);
      color:var(--text);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    }
    .card{
      max-width:520px;margin:0 auto;
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:12px;
      padding:16px;
      box-shadow:0 10px 30px rgba(0,0,0,.35);
    }
    h1{margin:0 0 12px;font-size:20px}
    .row{margin-bottom:10px}
    label{font-size:13px;color:var(--muted);display:block;margin-bottom:4px}
    input,select{
      width:100%;
      padding:8px;
      border-radius:8px;
      border:1px solid var(--border);
      background:#0d1117;
      color:var(--text)
    }
    button{
      width:100%;
      padding:10px;
      border-radius:10px;
      border:none;
      font-weight:700;
      background:var(--accent);
      color:#000;
      cursor:pointer;
    }
    .net{
      padding:8px;
      border:1px solid var(--border);
      border-radius:8px;
      margin-bottom:6px;
      cursor:pointer;
      background:#11161c;
      font-size:13px;
    }
    .net small{color:var(--muted)}
    a{color:var(--accent);font-size:13px;text-decoration:none}
  </style>
</head>
<body>
<div class="card">
  <h1>üì° WiFi Settings</h1>

  <div class="row">
    <label>SSID</label>
    <input id="ssid"/>
  </div>

  <div class="row">
    <label>Password</label>
    <input id="pass" type="password"/>
  </div>

  <div class="row">
    <label>
      <input type="checkbox" id="keep_ap"/> Keep Access Point enabled
    </label>
  </div>

  <button onclick="save()">Save & Apply</button>

  <div class="row" style="margin-top:14px">
    <label>Available Networks</label>
    <div id="nets"></div>
  </div>

  <div style="text-align:right;margin-top:8px">
    <a href="/">‚Üê Back to Status</a>
  </div>
</div>

<script>
const el=id=>document.getElementById(id);

function load(){
  fetch('/api/wifi').then(r=>r.json()).then(j=>{
    el('ssid').value=j.ssid||'';
    el('keep_ap').checked=!!j.keep_ap;
  });

  fetch('/api/wifi/scan').then(r=>r.json()).then(j=>{
    const host=el('nets');
    host.innerHTML='';
    j.networks.forEach(n=>{
      const d=document.createElement('div');
      d.className='net';
      d.innerHTML=`<b>${n.ssid||'(hidden)'}</b><br><small>RSSI ${n.rssi} ${n.enc?'üîí':''}</small>`;
      d.onclick=()=>el('ssid').value=n.ssid;
      host.appendChild(d);
    });
  });
}

function save(){
  fetch('/api/wifi',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({
      ssid:el('ssid').value,
      pass:el('pass').value,
      keep_ap:el('keep_ap').checked
    })
  }).then(()=>alert('Saved. Reconnecting‚Ä¶'));
}

load();
</script>
</body>
</html>
